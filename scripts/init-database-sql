/*
Create database and schemas 

Script purpose:
This script creates a database named 'Datawarehouse' after checking if it already exists.
If the database exists, it is dropped and then recreated . In addition to that, the script sets up three 
schemas within the database : 'Bronze', 'Silver' and 'Gold'.

WARNING:
Running this script will drop the entire database 'Datawarehouse' if it exists.
All the data in the database will be permanently deleted . Proceed with caution and ensure you have proper
backup before running this script.
*/
USE master;
GO
--Drop and recreate the database 'Datawarehouse'
IF EXISTS (SELECT 1 FROM sys.databases WHERE name= 'Datawarehouse')
BEGIN 
    ALTER DATABASE Datawarehouse SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
	DROP DATABASE Datawarehouse;
END; 
GO
--Create database'DataWarehouse'


CREATE DATABASE Datawarehouse;

USE Datawarehouse;

--Create schemas
CREATE SCHEMA Bronze;
GO
CREATE SCHEMA Silver;
GO
CREATE SCHEMA Gold;



